(this["webpackJsonparea-def-tool"]=this["webpackJsonparea-def-tool"]||[]).push([[0],[,,,,,,,,,,,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){},,function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var c=n(0),a=n.n(c),r=n(8),i=n.n(r),o=(n(14),n(3)),u=n(5),l=n(2),s=(n(15),n(16),n(1));function f(e){var t=e.source,n=e.setVideo,a=e.setSlider,r=Object(c.useRef)(null);Object(c.useEffect)((function(){r.current&&t&&(r.current.src=t,n(r.current))}),[t]);return Object(s.jsxs)("div",{className:"VideoCanvas",children:[Object(s.jsx)("input",{className:"slider",type:"range",min:"0",max:"100",onChange:function(e){!function(e){if(r.current){var t=e<0?0:e>100?100:e;r.current.currentTime=t/100*r.current.duration,a(t)}}(+e.target.value)}}),Object(s.jsx)("video",{ref:r,hidden:!0})]})}n(18);var j,d=function(e){var t=e.setFile,n=e.accept_types,a=void 0===n?"":n,r=Object(c.useRef)(null);return Object(s.jsx)("div",{className:"FilePicker",children:Object(s.jsx)("input",{ref:r,type:"file",accept:a,onChange:function(e){var n,c,a;return t(null!==(n=null===(c=r.current)||void 0===c||null===(a=c.files)||void 0===a?void 0:a.item(0))&&void 0!==n?n:null)}})})};!function(e){e[e.ADD=0]="ADD",e[e.SELECT=1]="SELECT"}(j||(j={}));n(19);function b(e){var t=e.value,n=e.onSelect,c=e.onAdd;return Object(s.jsxs)("div",{className:"ToolSelector",children:[Object(s.jsx)("button",{className:t===j.SELECT?"active":"",onClick:n,children:"SELECT"}),Object(s.jsx)("button",{className:t===j.ADD?"active":"",onClick:c,children:"ADD"})]})}var v=n(9);n(20);function O(e,t){for(var n=!1,c=0;c<t.length;c++){var a=[t[c],t[(c+1)%t.length]];(a[0][1]<=e[1]&&a[1][1]>=e[1]||a[1][1]<=e[1]&&a[0][1]>=e[1])&&e[0]<(a[0][0]-a[1][0])*(e[1]-a[1][1])/(a[0][1]-a[1][1])+a[1][0]&&(n=!n)}return n}function h(e){var t=e.img,n=e.quads,a=e.newQuad,r=e.tool,i=e.selected,f=e.setSelected,d=e.moveSelected,b=e.slider,h=Object(c.useState)([]),S=Object(l.a)(h,2),x=S[0],g=S[1],y=Object(c.useState)(!1),m=Object(l.a)(y,2),p=m[0],D=m[1],E=Object(c.useState)(null),C=Object(l.a)(E,2),T=C[0],A=C[1],L=Object(c.useRef)(null),N=Object(v.a)(L);Object(c.useEffect)((function(){var e=L.current,c=null===e||void 0===e?void 0:e.getContext("2d");if(e&&c){r===j.ADD&&f(-1),t?c.drawImage(t,0,0,1280,720):(c.fillStyle="#fff",c.fillRect(0,0,e.width,e.height)),c.strokeStyle="#f00",c.fillStyle="#00f";var a,l=Object(u.a)(n);try{for(l.s();!(a=l.n()).done;){var s=a.value;k(c,[].concat(Object(o.a)(s),[s[0]]),!0)}}catch(h){l.e(h)}finally{l.f()}if(i>=0&&n[i]){var b=n[i];c.strokeStyle="#ff0",c.fillStyle="#0ff",k(c,[].concat(Object(o.a)(b),[b[0]]),!0)}if(N.x&&N.y){if(x){var v=[[N.x,N.y]].concat(Object(o.a)(x));3===x.length&&(v=[x[2]].concat(Object(o.a)(v))),k(c,v,!0)}if(p&&T){var O=[N.x-T[0],N.y-T[1]];d(O)}A([N.x,N.y])}}}),[t,n,r,N,i,x,b]);var k=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t[0]&&e.moveTo(t[0][0],t[0][1]),e.beginPath();var c,a=Object(u.a)(t);try{for(a.s();!(c=a.n()).done;){var r=c.value;e.lineTo(r[0],r[1])}}catch(s){a.e(s)}finally{a.f()}if(e.stroke(),n){var i,o=Object(u.a)(t);try{for(o.s();!(i=o.n()).done;){var l=i.value;w(e,l)}}catch(s){o.e(s)}finally{o.f()}}},w=function(e,t){e.beginPath(),e.arc(t[0],t[1],5,0,6.3),e.closePath(),e.fill()},F=function(){var e=function(e,t){for(var n=0;n<t.length;n++)if(O(e,t[n]))return n;return-1}([N.x,N.y],n);e>=0&&e===i?D(!0):f(e)};return Object(s.jsx)("div",{className:"Canvas",children:Object(s.jsx)("canvas",{ref:L,onMouseDown:function(){switch(r){case j.ADD:!function(){if(N.x&&N.y){var e=[[N.x,N.y]].concat(Object(o.a)(x));4===e.length?(a(e),g([])):g(e)}}();break;case j.SELECT:F();break;default:throw Error("No tool selected???")}},onMouseUp:function(){D(!1)},onMouseLeave:function(){g([])},width:1280,height:720})})}n(21);function S(e){var t=e.target;return Object(s.jsx)("div",{className:"Inspector",children:JSON.stringify(t)})}function x(){var e=Object(c.useState)(null),t=Object(l.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(""),i=Object(l.a)(r,2),v=i[0],O=i[1],x=Object(c.useState)(null),g=Object(l.a)(x,2),y=g[0],m=g[1],p=Object(c.useState)(),D=Object(l.a)(p,2),E=D[0],C=D[1],T=Object(c.useState)([]),A=Object(l.a)(T,2),L=A[0],N=A[1],k=Object(c.useState)(-1),w=Object(l.a)(k,2),F=w[0],P=w[1],R=Object(c.useState)(j.ADD),I=Object(l.a)(R,2),M=I[0],J=I[1];Object(c.useEffect)((function(){if(n){var e=URL.createObjectURL(n);O(e)}}),[n]);return Object(s.jsxs)("div",{className:"App",children:[Object(s.jsx)(h,{img:y,quads:L,newQuad:function(e){N([e].concat(Object(o.a)(L)))},tool:M,selected:F,setSelected:P,moveSelected:function(e){var t,n=Object(u.a)(L[F]);try{for(n.s();!(t=n.n()).done;){var c=t.value;c[0]+=e[0],c[1]+=e[1]}}catch(a){n.e(a)}finally{n.f()}N(L)},slider:E}),Object(s.jsx)(f,{source:v,setVideo:m,setSlider:C}),Object(s.jsx)(d,{setFile:a,accept_types:"video/*"}),Object(s.jsx)(b,{value:M,onAdd:function(){return J(j.ADD)},onSelect:function(){return J(j.SELECT)}}),Object(s.jsx)(S,{target:L[F]})]})}var g=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,23)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),c(e),a(e),r(e),i(e)}))};i.a.render(Object(s.jsx)(a.a.StrictMode,{children:Object(s.jsx)(x,{})}),document.getElementById("root")),g()}],[[22,1,2]]]);
//# sourceMappingURL=main.b91547cc.chunk.js.map