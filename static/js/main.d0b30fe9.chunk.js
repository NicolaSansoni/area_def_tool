(this["webpackJsonparea-def-tool"]=this["webpackJsonparea-def-tool"]||[]).push([[0],[,,,,,,,,,,,,,,function(e,t,c){},function(e,t,c){},function(e,t,c){},,function(e,t,c){},function(e,t,c){},function(e,t,c){},function(e,t,c){},function(e,t,c){"use strict";c.r(t);var n=c(1),r=c.n(n),i=c(8),l=c.n(i),a=(c(14),c(3)),s=c(5),u=c(2),j=(c(15),c(16),c(0));function o(e){var t=e.source,c=e.setVideo,r=e.setSlider,i=e.value,l=Object(n.useRef)(null);Object(n.useEffect)((function(){l.current&&t&&(l.current.src=t,c(l.current),r(0))}),[t]);return Object(j.jsxs)("div",{className:"VideoCanvas",children:[Object(j.jsx)("input",{className:"slider",type:"range",min:"0",max:"100",value:i,onChange:function(e){!function(e){if(l.current){var t=e<0?0:e>100?100:e;l.current.currentTime=t/100*l.current.duration,r(t)}}(+e.target.value)}}),Object(j.jsx)("video",{ref:l,hidden:!0})]})}c(18);var d,b=function(e){var t=e.setFile,c=e.accept_types,r=void 0===c?"":c,i=Object(n.useRef)(null);return Object(j.jsx)("div",{className:"FilePicker",children:Object(j.jsx)("input",{ref:i,type:"file",accept:r,onChange:function(e){var c,n,r;return t(null!==(c=null===(n=i.current)||void 0===n||null===(r=n.files)||void 0===r?void 0:r.item(0))&&void 0!==c?c:null)}})})};!function(e){e[e.ADD=0]="ADD",e[e.SELECT=1]="SELECT"}(d||(d={}));c(19);function f(e){var t=e.value,c=e.onSelect,n=e.onAdd;return Object(j.jsxs)("div",{className:"ToolSelector",children:[Object(j.jsx)("button",{className:t===d.SELECT?"active":"",onClick:c,children:"SELECT"}),Object(j.jsx)("button",{className:t===d.ADD?"active":"",onClick:n,children:"ADD"})]})}var O=c(9);c(20);function h(e,t){for(var c=!1,n=0;n<t.length;n++){var r=[t[n],t[(n+1)%t.length]];(r[0][1]<=e[1]&&r[1][1]>=e[1]||r[1][1]<=e[1]&&r[0][1]>=e[1])&&e[0]<(r[0][0]-r[1][0])*(e[1]-r[1][1])/(r[0][1]-r[1][1])+r[1][0]&&(c=!c)}return c}function v(e,t){return Math.hypot(e[0]-t[0],e[1]-t[1])}function x(e){var t=e.img,c=e.quads,r=e.newQuad,i=e.tool,l=e.selected,o=e.setSelected,b=e.moveSelected,f=e.deleteSelected,x=e.slider,y=Object(n.useState)([]),S=Object(u.a)(y,2),g=S[0],p=S[1],m=Object(n.useState)(!1),D=Object(u.a)(m,2),C=D[0],E=D[1],k=Object(n.useState)(null),w=Object(u.a)(k,2),A=w[0],L=w[1],T=Object(n.useRef)(null),N=Object(O.a)(T);Object(n.useEffect)((function(){var e=T.current,n=null===e||void 0===e?void 0:e.getContext("2d");if(e&&n){i===d.ADD&&o(-1),t?n.drawImage(t,0,0,1280,720):(n.fillStyle="#fff",n.fillRect(0,0,e.width,e.height)),n.strokeStyle="#f00",n.fillStyle="#00f";var r,u=Object(s.a)(c);try{for(u.s();!(r=u.n()).done;){var j=r.value;P(n,[].concat(Object(a.a)(j),[j[0]]),!0)}}catch(v){u.e(v)}finally{u.f()}if(l>=0&&c[l]){var f=c[l];n.strokeStyle="#ff0",n.fillStyle="#0ff",P(n,[].concat(Object(a.a)(f),[f[0]]),!0)}if(N.x&&N.y){if(g&&i===d.ADD){var O=[F([N.x,N.y],c)].concat(Object(a.a)(g));3===g.length&&(O=[g[2]].concat(Object(a.a)(O))),P(n,O,!0)}if(C&&A&&l>=0){var h=[N.x-A[0],N.y-A[1]];b(h)}L([N.x,N.y])}}}),[t,c,i,N,l,g,x]);var F=function(e,t){var c=t.reduce((function(t,c){var n=Object(u.a)(t,2),r=n[0],i=n[1],l=c.reduce((function(t,c,n,r){var i=Object(u.a)(t,2),l=i[0],a=i[1],s=r[(n+1)%r.length];console.log(n,c,s);var j,o,d=function(e,t){var c,n,r=[t[1][0]-t[0][0],t[1][1]-t[0][1]],i=[e[0]-t[0][0],e[1]-t[0][1]],l=(c=r)[0]*(n=i)[0]+c[1]*n[0],a=r[0]*r[0]+r[1]*r[1],s=[t[0][0]+l*r[0]/a,t[0][1]+l*r[1]/a];return s[0]>t[0][0]&&s[0]>t[1][0]||s[0]<t[0][0]&&s[0]<t[1][0]||s[1]>t[0][1]&&s[1]>t[1][1]||s[1]<t[0][1]&&s[1]<t[1][1]?null:s}(e,[c,s]);if(d)j=v(e,d),o=d;else{var b=v(e,c),f=v(e,s),O=b<f?[b,c]:[f,s],h=Object(u.a)(O,2);j=h[0],o=h[1]}return j<l||-1===l?[j,o]:[l,a]}),[-1,null]),a=Object(u.a)(l,2),s=a[0],j=a[1];return s<r||-1===r?[s,j]:[r,i]}),[-1,null]),n=Object(u.a)(c,2),r=n[0],i=n[1];return i&&r<50&&(e=i),e},P=function(e,t){var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t[0]&&e.moveTo(t[0][0],t[0][1]),e.beginPath();var n,r=Object(s.a)(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;e.lineTo(i[0],i[1])}}catch(j){r.e(j)}finally{r.f()}if(e.stroke(),c){var l,a=Object(s.a)(t);try{for(a.s();!(l=a.n()).done;){var u=l.value;R(e,u)}}catch(j){a.e(j)}finally{a.f()}}},R=function(e,t){e.beginPath(),e.arc(t[0],t[1],5,0,6.3),e.closePath(),e.fill()},M=function(){var e=function(e,t){for(var c=0;c<t.length;c++)if(h(e,t[c]))return c;return-1}([N.x,N.y],c);e>=0&&e===l?E(!0):o(e)};return Object(j.jsx)("div",{className:"Canvas",children:Object(j.jsx)("canvas",{ref:T,onMouseDown:function(){switch(i){case d.ADD:!function(){if(N.x&&N.y){var e=[N.x,N.y],t=[e=F(e,c)].concat(Object(a.a)(g));4===t.length?(r(t),p([])):p(t)}}();break;case d.SELECT:M();break;default:throw Error("No tool selected???")}},onMouseUp:function(){E(!1)},onMouseLeave:function(){p([]),C&&l>=0&&f()},width:1280,height:720})})}c(21);function y(e){var t=e.target,c=null;t&&(c=function(e){var t=function(e){var t=e.sort((function(e,t){return e[1]>t[1]?-1:1}));if(t[0][0]>t[1][0]){var c=t[0];t[0]=t[1],t[1]=c}if(t[2][0]<t[3][0]){var n=t[2];t[2]=t[3],t[3]=n}return t}(e);return{lu:{x:t[0][0],y:t[0][1]},ru:{x:t[1][0],y:t[1][1]},rb:{x:t[2][0],y:t[2][1]},lb:{x:t[3][0],y:t[3][1]},carWalk:!0,direction:{left:!1,up:!1,right:!1,down:!1},parking:!1,stop:null}}(t));return Object(j.jsx)("div",{className:"Inspector",children:Object(j.jsxs)("table",{children:[Object(j.jsx)("thead",{children:Object(j.jsxs)("tr",{children:[Object(j.jsx)("th",{children:"luX     "}),Object(j.jsx)("th",{children:"luY     "}),Object(j.jsx)("th",{children:"ruX     "}),Object(j.jsx)("th",{children:"ruY     "}),Object(j.jsx)("th",{children:"rbX     "}),Object(j.jsx)("th",{children:"rbY     "}),Object(j.jsx)("th",{children:"lbX     "}),Object(j.jsx)("th",{children:"lbY     "}),Object(j.jsx)("th",{children:"CarWalk "}),Object(j.jsx)("th",{children:"Left    "}),Object(j.jsx)("th",{children:"Up      "}),Object(j.jsx)("th",{children:"Right   "}),Object(j.jsx)("th",{children:"Down    "}),Object(j.jsx)("th",{children:"Parking "}),Object(j.jsx)("th",{children:"Stop    "})]})}),Object(j.jsx)("tbody",{children:function(e){if(e)return Object(j.jsxs)("tr",{children:[Object(j.jsxs)("td",{children:[e.lu.x,"        "]}),Object(j.jsxs)("td",{children:[e.lu.y,"        "]}),Object(j.jsxs)("td",{children:[e.ru.x,"        "]}),Object(j.jsxs)("td",{children:[e.ru.y,"        "]}),Object(j.jsxs)("td",{children:[e.rb.x,"        "]}),Object(j.jsxs)("td",{children:[e.rb.y,"        "]}),Object(j.jsxs)("td",{children:[e.lb.x,"        "]}),Object(j.jsxs)("td",{children:[e.lb.y,"        "]}),Object(j.jsxs)("td",{children:[e.carWalk,"        "]}),Object(j.jsxs)("td",{children:[e.direction.left," "]}),Object(j.jsxs)("td",{children:[e.direction.up,"   "]}),Object(j.jsx)("td",{children:e.direction.right}),Object(j.jsxs)("td",{children:[e.direction.down," "]}),Object(j.jsxs)("td",{children:[e.parking,"        "]}),Object(j.jsxs)("td",{children:[e.stop,"        "]})]})}(c)})]})})}function S(){var e=Object(n.useState)(null),t=Object(u.a)(e,2),c=t[0],r=t[1],i=Object(n.useState)(""),l=Object(u.a)(i,2),O=l[0],h=l[1],v=Object(n.useState)(null),S=Object(u.a)(v,2),g=S[0],p=S[1],m=Object(n.useState)(),D=Object(u.a)(m,2),C=D[0],E=D[1],k=Object(n.useState)([]),w=Object(u.a)(k,2),A=w[0],L=w[1],T=Object(n.useState)(-1),N=Object(u.a)(T,2),F=N[0],P=N[1],R=Object(n.useState)(d.ADD),M=Object(u.a)(R,2),I=M[0],U=M[1];Object(n.useEffect)((function(){if(c){var e=URL.createObjectURL(c);h(e)}}),[c]);return Object(j.jsxs)("div",{className:"App",children:[Object(j.jsx)(x,{img:g,quads:A,newQuad:function(e){L([e].concat(Object(a.a)(A)))},tool:I,selected:F,setSelected:P,moveSelected:function(e){var t,c=Object(s.a)(A[F]);try{for(c.s();!(t=c.n()).done;){var n=t.value;n[0]+=e[0],n[1]+=e[1]}}catch(r){c.e(r)}finally{c.f()}L(A)},deleteSelected:function(){A.splice(F,1),L(A),P(-1)},slider:C}),Object(j.jsx)(o,{source:O,setVideo:p,setSlider:E,value:null!==C&&void 0!==C?C:0}),Object(j.jsx)(b,{setFile:r,accept_types:"video/*"}),Object(j.jsx)(f,{value:I,onAdd:function(){return U(d.ADD)},onSelect:function(){return U(d.SELECT)}}),Object(j.jsx)(y,{target:A[F]})]})}var g=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,23)).then((function(t){var c=t.getCLS,n=t.getFID,r=t.getFCP,i=t.getLCP,l=t.getTTFB;c(e),n(e),r(e),i(e),l(e)}))};l.a.render(Object(j.jsx)(r.a.StrictMode,{children:Object(j.jsx)(S,{})}),document.getElementById("root")),g()}],[[22,1,2]]]);
//# sourceMappingURL=main.d0b30fe9.chunk.js.map