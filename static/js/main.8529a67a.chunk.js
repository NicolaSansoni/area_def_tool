(this["webpackJsonparea-def-tool"]=this["webpackJsonparea-def-tool"]||[]).push([[0],[,,,,,,,,,,,,,,function(e,t,c){},function(e,t,c){},function(e,t,c){},,function(e,t,c){},function(e,t,c){},function(e,t,c){},function(e,t,c){},function(e,t,c){"use strict";c.r(t);var n=c(1),r=c.n(n),i=c(8),a=c.n(i),l=(c(14),c(3)),u=c(5),s=c(2),o=(c(15),c(16),c(0));function j(e){var t=e.source,c=e.setVideo,r=e.setSlider,i=e.value,a=Object(n.useRef)(null);Object(n.useEffect)((function(){a.current&&t&&(a.current.src=t,c(a.current),r(0))}),[t]);return Object(o.jsxs)("div",{className:"VideoCanvas",children:[Object(o.jsx)("input",{className:"slider",type:"range",min:"0",max:"100",value:i,onChange:function(e){!function(e){if(a.current){var t=e<0?0:e>100?100:e;a.current.currentTime=t/100*a.current.duration,r(t)}}(+e.target.value)}}),Object(o.jsx)("video",{ref:a,hidden:!0})]})}c(18);var d,b=function(e){var t=e.setFile,c=e.accept_types,r=void 0===c?"":c,i=Object(n.useRef)(null);return Object(o.jsx)("div",{className:"FilePicker",children:Object(o.jsx)("input",{ref:i,type:"file",accept:r,onChange:function(e){var c,n,r;return t(null!==(c=null===(n=i.current)||void 0===n||null===(r=n.files)||void 0===r?void 0:r.item(0))&&void 0!==c?c:null)}})})};!function(e){e[e.ADD=0]="ADD",e[e.SELECT=1]="SELECT"}(d||(d={}));c(19);function f(e){var t=e.value,c=e.onSelect,n=e.onAdd;return Object(o.jsxs)("div",{className:"ToolSelector",children:[Object(o.jsx)("button",{className:t===d.SELECT?"active":"",onClick:c,children:"SELECT"}),Object(o.jsx)("button",{className:t===d.ADD?"active":"",onClick:n,children:"ADD"})]})}var h=c(9);c(20);function O(e,t){for(var c=!1,n=0;n<t.length;n++){var r=[t[n],t[(n+1)%t.length]];(r[0][1]<=e[1]&&r[1][1]>=e[1]||r[1][1]<=e[1]&&r[0][1]>=e[1])&&e[0]<(r[0][0]-r[1][0])*(e[1]-r[1][1])/(r[0][1]-r[1][1])+r[1][0]&&(c=!c)}return c}function v(e,t){return Math.hypot(e[0]-t[0],e[1]-t[1])}function x(e,t){return[e[0]+t[0],e[1]+t[1]]}function y(e,t){return x(e,[-(c=t)[0],-c[1]]);var c}function S(e,t){return[e[0]*t,e[1]*t]}function g(e){var t=e.img,c=e.quads,r=e.newQuad,i=e.tool,a=e.selected,j=e.setSelected,b=e.moveSelected,f=e.deleteSelected,g=e.slider,p=Object(n.useState)([]),m=Object(s.a)(p,2),D=m[0],C=m[1],E=Object(n.useState)(!1),k=Object(s.a)(E,2),w=k[0],M=k[1],A=Object(n.useState)(null),L=Object(s.a)(A,2),T=L[0],N=L[1],F=Object(n.useRef)(null),P=Object(h.a)(F);Object(n.useEffect)((function(){var e=F.current,n=null===e||void 0===e?void 0:e.getContext("2d");if(e&&n){i===d.ADD&&j(-1),t?n.drawImage(t,0,0,1280,720):(n.fillStyle="#fff",n.fillRect(0,0,e.width,e.height)),n.strokeStyle="#f00",n.fillStyle="#00f";var r,s=Object(u.a)(c);try{for(s.s();!(r=s.n()).done;){var o=r.value;I(n,[].concat(Object(l.a)(o),[o[0]]),!0)}}catch(v){s.e(v)}finally{s.f()}if(a>=0&&c[a]){var f=c[a];n.strokeStyle="#ff0",n.fillStyle="#0ff",I(n,[].concat(Object(l.a)(f),[f[0]]),!0)}if(P.x&&P.y){if(D&&i===d.ADD){var h=[R([P.x,P.y],c)].concat(Object(l.a)(D));3===D.length&&(h=[D[2]].concat(Object(l.a)(h))),I(n,h,!0)}if(w&&T&&a>=0){var O=[P.x-T[0],P.y-T[1]];b(O)}N([P.x,P.y])}}}),[t,c,i,P,a,D,g]);var R=function(e,t){var c=t.reduce((function(t,c){var n=Object(s.a)(t,2),r=n[0],i=n[1],a=c.reduce((function(t,c,n,r){var i=Object(s.a)(t,2),a=i[0],u=i[1],o=r[(n+1)%r.length];console.log(n,c,o);var j,d,b=function(e,t){var c,n,r=y(t[1],t[0]),i=v(t[0],t[1]),a=S(r,1/i),l=(c=y(e,t[0]),n=a,c[0]*n[0]+c[1]*n[1]);return l<0||l>i?null:x(t[0],S(a,l))}(e,[c,o]);if(b)j=v(e,b),d=b;else{var f=v(e,c),h=v(e,o),O=f<h?[f,Object(l.a)(c)]:[h,Object(l.a)(o)],g=Object(s.a)(O,2);j=g[0],d=g[1]}return j<a||-1===a?[j,d]:[a,u]}),[-1,null]),u=Object(s.a)(a,2),o=u[0],j=u[1];return o<r||-1===r?[o,j]:[r,i]}),[-1,null]),n=Object(s.a)(c,2),r=n[0],i=n[1];return i&&r<50&&(e=i),e},I=function(e,t){var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t[0]&&e.moveTo(t[0][0],t[0][1]),e.beginPath();var n,r=Object(u.a)(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;e.lineTo(i[0],i[1])}}catch(o){r.e(o)}finally{r.f()}if(e.stroke(),c){var a,l=Object(u.a)(t);try{for(l.s();!(a=l.n()).done;){var s=a.value;U(e,s)}}catch(o){l.e(o)}finally{l.f()}}},U=function(e,t){e.beginPath(),e.arc(t[0],t[1],5,0,6.3),e.closePath(),e.fill()},X=function(){var e=function(e,t){for(var c=0;c<t.length;c++)if(O(e,t[c]))return c;return-1}([P.x,P.y],c);e>=0&&e===a?M(!0):j(e)};return Object(o.jsx)("div",{className:"Canvas",children:Object(o.jsx)("canvas",{ref:F,onMouseDown:function(){switch(i){case d.ADD:!function(){if(P.x&&P.y){var e=[P.x,P.y],t=[e=R(e,c)].concat(Object(l.a)(D));4===t.length?(r(t),C([])):C(t)}}();break;case d.SELECT:X();break;default:throw Error("No tool selected???")}},onMouseUp:function(){M(!1)},onMouseLeave:function(){C([]),w&&a>=0&&f()},width:1280,height:720})})}c(21);function p(e){var t=e.target,c=null;t&&(c=function(e){var t=function(e){var t=e.sort((function(e,t){return e[1]<t[1]?-1:1}));if(t[0][0]>t[1][0]){var c=t[0];t[0]=t[1],t[1]=c}if(t[2][0]<t[3][0]){var n=t[2];t[2]=t[3],t[3]=n}return t}(e);return{lu:{x:Math.round(t[0][0]),y:Math.round(t[0][1])},ru:{x:Math.round(t[1][0]),y:Math.round(t[1][1])},rb:{x:Math.round(t[2][0]),y:Math.round(t[2][1])},lb:{x:Math.round(t[3][0]),y:Math.round(t[3][1])},carWalk:!0,direction:{left:!1,up:!1,right:!1,down:!1},parking:!1,stop:null}}(t));return Object(o.jsx)("div",{className:"Inspector",children:Object(o.jsxs)("table",{children:[Object(o.jsx)("thead",{children:Object(o.jsxs)("tr",{children:[Object(o.jsx)("th",{children:"luX     "}),Object(o.jsx)("th",{children:"luY     "}),Object(o.jsx)("th",{children:"ruX     "}),Object(o.jsx)("th",{children:"ruY     "}),Object(o.jsx)("th",{children:"rbX     "}),Object(o.jsx)("th",{children:"rbY     "}),Object(o.jsx)("th",{children:"lbX     "}),Object(o.jsx)("th",{children:"lbY     "}),Object(o.jsx)("th",{children:"CarWalk "}),Object(o.jsx)("th",{children:"Left    "}),Object(o.jsx)("th",{children:"Up      "}),Object(o.jsx)("th",{children:"Right   "}),Object(o.jsx)("th",{children:"Down    "}),Object(o.jsx)("th",{children:"Parking "}),Object(o.jsx)("th",{children:"Stop    "})]})}),Object(o.jsx)("tbody",{children:function(e){if(e)return Object(o.jsxs)("tr",{children:[Object(o.jsxs)("td",{children:[e.lu.x,"        "]}),Object(o.jsxs)("td",{children:[e.lu.y,"        "]}),Object(o.jsxs)("td",{children:[e.ru.x,"        "]}),Object(o.jsxs)("td",{children:[e.ru.y,"        "]}),Object(o.jsxs)("td",{children:[e.rb.x,"        "]}),Object(o.jsxs)("td",{children:[e.rb.y,"        "]}),Object(o.jsxs)("td",{children:[e.lb.x,"        "]}),Object(o.jsxs)("td",{children:[e.lb.y,"        "]}),Object(o.jsxs)("td",{children:[e.carWalk,"        "]}),Object(o.jsxs)("td",{children:[e.direction.left," "]}),Object(o.jsxs)("td",{children:[e.direction.up,"   "]}),Object(o.jsx)("td",{children:e.direction.right}),Object(o.jsxs)("td",{children:[e.direction.down," "]}),Object(o.jsxs)("td",{children:[e.parking,"        "]}),Object(o.jsxs)("td",{children:[e.stop,"        "]})]})}(c)})]})})}function m(){var e=Object(n.useState)(null),t=Object(s.a)(e,2),c=t[0],r=t[1],i=Object(n.useState)(""),a=Object(s.a)(i,2),h=a[0],O=a[1],v=Object(n.useState)(null),x=Object(s.a)(v,2),y=x[0],S=x[1],m=Object(n.useState)(),D=Object(s.a)(m,2),C=D[0],E=D[1],k=Object(n.useState)([]),w=Object(s.a)(k,2),M=w[0],A=w[1],L=Object(n.useState)(-1),T=Object(s.a)(L,2),N=T[0],F=T[1],P=Object(n.useState)(d.ADD),R=Object(s.a)(P,2),I=R[0],U=R[1];Object(n.useEffect)((function(){if(c){var e=URL.createObjectURL(c);O(e)}}),[c]);return Object(o.jsxs)("div",{className:"App",children:[Object(o.jsx)(g,{img:y,quads:M,newQuad:function(e){A([e].concat(Object(l.a)(M)))},tool:I,selected:N,setSelected:F,moveSelected:function(e){var t,c=Object(u.a)(M[N]);try{for(c.s();!(t=c.n()).done;){var n=t.value;n[0]+=e[0],n[1]+=e[1]}}catch(r){c.e(r)}finally{c.f()}},deleteSelected:function(){M.splice(N,1),A(M),F(-1)},slider:C}),Object(o.jsx)(j,{source:h,setVideo:S,setSlider:E,value:null!==C&&void 0!==C?C:0}),Object(o.jsx)(b,{setFile:r,accept_types:"video/*"}),Object(o.jsx)(f,{value:I,onAdd:function(){return U(d.ADD)},onSelect:function(){return U(d.SELECT)}}),Object(o.jsx)(p,{target:M[N]})]})}var D=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,23)).then((function(t){var c=t.getCLS,n=t.getFID,r=t.getFCP,i=t.getLCP,a=t.getTTFB;c(e),n(e),r(e),i(e),a(e)}))};a.a.render(Object(o.jsx)(r.a.StrictMode,{children:Object(o.jsx)(m,{})}),document.getElementById("root")),D()}],[[22,1,2]]]);
//# sourceMappingURL=main.8529a67a.chunk.js.map