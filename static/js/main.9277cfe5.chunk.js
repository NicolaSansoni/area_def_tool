(this["webpackJsonparea-def-tool"]=this["webpackJsonparea-def-tool"]||[]).push([[0],[,,,,,,,,,,,,,,function(e,t,c){},function(e,t,c){},function(e,t,c){},,function(e,t,c){},function(e,t,c){},function(e,t,c){},function(e,t,c){},function(e,t,c){"use strict";c.r(t);var n=c(1),r=c.n(n),i=c(8),a=c.n(i),l=(c(14),c(3)),s=c(5),u=c(2),o=(c(15),c(16),c(0));function j(e){var t=e.source,c=e.setVideo,r=e.setSlider,i=e.value,a=Object(n.useRef)(null);Object(n.useEffect)((function(){a.current&&t&&(a.current.src=t,c(a.current),r(0))}),[t]);return Object(o.jsxs)("div",{className:"VideoCanvas",children:[Object(o.jsx)("input",{className:"slider",type:"range",min:"0",max:"100",value:i,onChange:function(e){!function(e){if(a.current){var t=e<0?0:e>100?100:e;a.current.currentTime=t/100*a.current.duration,r(t)}}(+e.target.value)}}),Object(o.jsx)("video",{ref:a,hidden:!0})]})}c(18);var d,b=function(e){var t=e.setFile,c=e.accept_types,r=void 0===c?"":c,i=Object(n.useRef)(null);return Object(o.jsx)("div",{className:"FilePicker",children:Object(o.jsx)("input",{ref:i,type:"file",accept:r,onChange:function(e){var c,n,r;return t(null!==(c=null===(n=i.current)||void 0===n||null===(r=n.files)||void 0===r?void 0:r.item(0))&&void 0!==c?c:null)}})})};!function(e){e[e.ADD=0]="ADD",e[e.SELECT=1]="SELECT"}(d||(d={}));c(19);function f(e){var t=e.value,c=e.onSelect,n=e.onAdd;return Object(o.jsxs)("div",{className:"ToolSelector",children:[Object(o.jsx)("button",{className:t===d.SELECT?"active":"",onClick:c,children:"SELECT"}),Object(o.jsx)("button",{className:t===d.ADD?"active":"",onClick:n,children:"ADD"})]})}var h=c(9);c(20);function O(e,t){for(var c=!1,n=0;n<t.length;n++){var r=[t[n],t[(n+1)%t.length]];(r[0][1]<=e[1]&&r[1][1]>=e[1]||r[1][1]<=e[1]&&r[0][1]>=e[1])&&e[0]<(r[0][0]-r[1][0])*(e[1]-r[1][1])/(r[0][1]-r[1][1])+r[1][0]&&(c=!c)}return c}function v(e,t){return Math.hypot(e[0]-t[0],e[1]-t[1])}function x(e){var t=e.img,c=e.quads,r=e.newQuad,i=e.tool,a=e.selected,j=e.setSelected,b=e.moveSelected,f=e.deleteSelected,x=e.slider,y=Object(n.useState)([]),S=Object(u.a)(y,2),g=S[0],p=S[1],m=Object(n.useState)(!1),D=Object(u.a)(m,2),C=D[0],E=D[1],k=Object(n.useState)(null),w=Object(u.a)(k,2),M=w[0],A=w[1],L=Object(n.useRef)(null),T=Object(h.a)(L);Object(n.useEffect)((function(){var e=L.current,n=null===e||void 0===e?void 0:e.getContext("2d");if(e&&n){i===d.ADD&&j(-1),t?n.drawImage(t,0,0,1280,720):(n.fillStyle="#fff",n.fillRect(0,0,e.width,e.height)),n.strokeStyle="#f00",n.fillStyle="#00f";var r,u=Object(s.a)(c);try{for(u.s();!(r=u.n()).done;){var o=r.value;F(n,[].concat(Object(l.a)(o),[o[0]]),!0)}}catch(v){u.e(v)}finally{u.f()}if(a>=0&&c[a]){var f=c[a];n.strokeStyle="#ff0",n.fillStyle="#0ff",F(n,[].concat(Object(l.a)(f),[f[0]]),!0)}if(T.x&&T.y){if(g&&i===d.ADD){var h=[N([T.x,T.y],c)].concat(Object(l.a)(g));3===g.length&&(h=[g[2]].concat(Object(l.a)(h))),F(n,h,!0)}if(C&&M&&a>=0){var O=[T.x-M[0],T.y-M[1]];b(O)}A([T.x,T.y])}}}),[t,c,i,T,a,g,x]);var N=function(e,t){var c=t.reduce((function(t,c){var n=Object(u.a)(t,2),r=n[0],i=n[1],a=c.reduce((function(t,c,n,r){var i=Object(u.a)(t,2),a=i[0],s=i[1],o=r[(n+1)%r.length];console.log(n,c,o);var j,d,b=function(e,t){var c=[e[0],e[1]],n=c[0],r=c[1],i=[t[0][0],t[0][1]],a=i[0],l=i[1],s=[t[1][0],t[1][1]],u=s[0],o=s[1],j=(l-o)/(a-u),d=(a*o-u*l)/(a-u),b=-1/j,f=(r-b*n-d)/(j-b),h=[f,j*f+d];return h[0]>t[0][0]&&h[0]>t[1][0]||h[0]<t[0][0]&&h[0]<t[1][0]||h[1]>t[0][1]&&h[1]>t[1][1]||h[1]<t[0][1]&&h[1]<t[1][1]?null:h}(e,[c,o]);if(b)j=v(e,b),d=b;else{var f=v(e,c),h=v(e,o),O=f<h?[f,Object(l.a)(c)]:[h,Object(l.a)(o)],x=Object(u.a)(O,2);j=x[0],d=x[1]}return j<a||-1===a?[j,d]:[a,s]}),[-1,null]),s=Object(u.a)(a,2),o=s[0],j=s[1];return o<r||-1===r?[o,j]:[r,i]}),[-1,null]),n=Object(u.a)(c,2),r=n[0],i=n[1];return i&&r<50&&(e=i),e},F=function(e,t){var c=arguments.length>2&&void 0!==arguments[2]&&arguments[2];t[0]&&e.moveTo(t[0][0],t[0][1]),e.beginPath();var n,r=Object(s.a)(t);try{for(r.s();!(n=r.n()).done;){var i=n.value;e.lineTo(i[0],i[1])}}catch(o){r.e(o)}finally{r.f()}if(e.stroke(),c){var a,l=Object(s.a)(t);try{for(l.s();!(a=l.n()).done;){var u=a.value;P(e,u)}}catch(o){l.e(o)}finally{l.f()}}},P=function(e,t){e.beginPath(),e.arc(t[0],t[1],5,0,6.3),e.closePath(),e.fill()},R=function(){var e=function(e,t){for(var c=0;c<t.length;c++)if(O(e,t[c]))return c;return-1}([T.x,T.y],c);e>=0&&e===a?E(!0):j(e)};return Object(o.jsx)("div",{className:"Canvas",children:Object(o.jsx)("canvas",{ref:L,onMouseDown:function(){switch(i){case d.ADD:!function(){if(T.x&&T.y){var e=[T.x,T.y],t=[e=N(e,c)].concat(Object(l.a)(g));4===t.length?(r(t),p([])):p(t)}}();break;case d.SELECT:R();break;default:throw Error("No tool selected???")}},onMouseUp:function(){E(!1)},onMouseLeave:function(){p([]),C&&a>=0&&f()},width:1280,height:720})})}c(21);function y(e){var t=e.target,c=null;t&&(c=function(e){var t=function(e){var t=e.sort((function(e,t){return e[1]<t[1]?-1:1}));if(t[0][0]>t[1][0]){var c=t[0];t[0]=t[1],t[1]=c}if(t[2][0]<t[3][0]){var n=t[2];t[2]=t[3],t[3]=n}return t}(e);return{lu:{x:Math.round(t[0][0]),y:Math.round(t[0][1])},ru:{x:Math.round(t[1][0]),y:Math.round(t[1][1])},rb:{x:Math.round(t[2][0]),y:Math.round(t[2][1])},lb:{x:Math.round(t[3][0]),y:Math.round(t[3][1])},carWalk:!0,direction:{left:!1,up:!1,right:!1,down:!1},parking:!1,stop:null}}(t));return Object(o.jsx)("div",{className:"Inspector",children:Object(o.jsxs)("table",{children:[Object(o.jsx)("thead",{children:Object(o.jsxs)("tr",{children:[Object(o.jsx)("th",{children:"luX     "}),Object(o.jsx)("th",{children:"luY     "}),Object(o.jsx)("th",{children:"ruX     "}),Object(o.jsx)("th",{children:"ruY     "}),Object(o.jsx)("th",{children:"rbX     "}),Object(o.jsx)("th",{children:"rbY     "}),Object(o.jsx)("th",{children:"lbX     "}),Object(o.jsx)("th",{children:"lbY     "}),Object(o.jsx)("th",{children:"CarWalk "}),Object(o.jsx)("th",{children:"Left    "}),Object(o.jsx)("th",{children:"Up      "}),Object(o.jsx)("th",{children:"Right   "}),Object(o.jsx)("th",{children:"Down    "}),Object(o.jsx)("th",{children:"Parking "}),Object(o.jsx)("th",{children:"Stop    "})]})}),Object(o.jsx)("tbody",{children:function(e){if(e)return Object(o.jsxs)("tr",{children:[Object(o.jsxs)("td",{children:[e.lu.x,"        "]}),Object(o.jsxs)("td",{children:[e.lu.y,"        "]}),Object(o.jsxs)("td",{children:[e.ru.x,"        "]}),Object(o.jsxs)("td",{children:[e.ru.y,"        "]}),Object(o.jsxs)("td",{children:[e.rb.x,"        "]}),Object(o.jsxs)("td",{children:[e.rb.y,"        "]}),Object(o.jsxs)("td",{children:[e.lb.x,"        "]}),Object(o.jsxs)("td",{children:[e.lb.y,"        "]}),Object(o.jsxs)("td",{children:[e.carWalk,"        "]}),Object(o.jsxs)("td",{children:[e.direction.left," "]}),Object(o.jsxs)("td",{children:[e.direction.up,"   "]}),Object(o.jsx)("td",{children:e.direction.right}),Object(o.jsxs)("td",{children:[e.direction.down," "]}),Object(o.jsxs)("td",{children:[e.parking,"        "]}),Object(o.jsxs)("td",{children:[e.stop,"        "]})]})}(c)})]})})}function S(){var e=Object(n.useState)(null),t=Object(u.a)(e,2),c=t[0],r=t[1],i=Object(n.useState)(""),a=Object(u.a)(i,2),h=a[0],O=a[1],v=Object(n.useState)(null),S=Object(u.a)(v,2),g=S[0],p=S[1],m=Object(n.useState)(),D=Object(u.a)(m,2),C=D[0],E=D[1],k=Object(n.useState)([]),w=Object(u.a)(k,2),M=w[0],A=w[1],L=Object(n.useState)(-1),T=Object(u.a)(L,2),N=T[0],F=T[1],P=Object(n.useState)(d.ADD),R=Object(u.a)(P,2),I=R[0],U=R[1];Object(n.useEffect)((function(){if(c){var e=URL.createObjectURL(c);O(e)}}),[c]);return Object(o.jsxs)("div",{className:"App",children:[Object(o.jsx)(x,{img:g,quads:M,newQuad:function(e){A([e].concat(Object(l.a)(M)))},tool:I,selected:N,setSelected:F,moveSelected:function(e){var t,c=Object(s.a)(M[N]);try{for(c.s();!(t=c.n()).done;){var n=t.value;n[0]+=e[0],n[1]+=e[1]}}catch(r){c.e(r)}finally{c.f()}},deleteSelected:function(){M.splice(N,1),A(M),F(-1)},slider:C}),Object(o.jsx)(j,{source:h,setVideo:p,setSlider:E,value:null!==C&&void 0!==C?C:0}),Object(o.jsx)(b,{setFile:r,accept_types:"video/*"}),Object(o.jsx)(f,{value:I,onAdd:function(){return U(d.ADD)},onSelect:function(){return U(d.SELECT)}}),Object(o.jsx)(y,{target:M[N]})]})}var g=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,23)).then((function(t){var c=t.getCLS,n=t.getFID,r=t.getFCP,i=t.getLCP,a=t.getTTFB;c(e),n(e),r(e),i(e),a(e)}))};a.a.render(Object(o.jsx)(r.a.StrictMode,{children:Object(o.jsx)(S,{})}),document.getElementById("root")),g()}],[[22,1,2]]]);
//# sourceMappingURL=main.9277cfe5.chunk.js.map